#!/bin/bash
set -e

LFS_PART=$1
LFS=$2
REPO_ORIGIN_SOURCES=$3
DATADIR=$4

if [ ! -d "$2" ]
then
      sudo mkdir $2
fi

echo ">>>Validacion de versiones.."
bdt-version-check

echo ">>>Particionando disco.."
echo ">>>Entrando en modo sudo.."
sudo bdt-prephost-formatdisk $1 $2


echo ">>>Descargo paquetes.."
bdt-prephost-download $3

echo ">>>Preparando directorio de tools"
sudo mkdir -v $2/tools
sudo ln -sv $2/tools /

echo ">>>Creando usuario."
bdt-prephost-user $DATADIR

echo ">>>Moviendo archivos de trabajo."
sudo cp -r $REPO_ORIGIN_SOURCES $2
sudo cp -r tmpsys $2/tools


echo ">>>Login in lfs"
su - lfs

